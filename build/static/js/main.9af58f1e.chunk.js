(this["webpackJsonpchat-lite"]=this["webpackJsonpchat-lite"]||[]).push([[0],{105:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),c=n(48),r=n.n(c),o=(n(55),n(3)),u=n(11),i=n.n(u),j=n(17),l=n(9),b=n(19),d=n.n(b),O=n(0);var m=function(e){var t=e.onLogin,n=Object(a.useState)(""),s=Object(l.a)(n,2),c=s[0],r=s[1],o=Object(a.useState)(""),u=Object(l.a)(o,2),b=u[0],m=u[1],p=Object(a.useState)(!1),f=Object(l.a)(p,2),h=f[0],x=f[1],y=function(){var e=Object(j.a)(i.a.mark((function e(n){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!=n.key&&"click"!=n.type){e.next=8;break}if(c&&b){e.next=3;break}return e.abrupt("return",alert("\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435"));case 3:return a={roomId:c,userName:b},x(!0),e.next=7,d.a.post("/rooms",a);case 7:t(a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(O.jsxs)("div",{className:"join-block",children:[Object(O.jsx)("input",{type:"text",placeholder:"Room ID",value:c,onChange:function(e){return r(e.target.value)},onKeyPress:y}),Object(O.jsx)("input",{type:"text",placeholder:"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f",value:b,onChange:function(e){return m(e.target.value)},onKeyPress:y}),Object(O.jsx)("button",{disabled:h,className:"btn btn-success",onClick:y,children:h?"\u0412\u0425\u041e\u0414...":"\u0412\u041e\u0419\u0422\u0418"})]})},p=n(49),f=n.n(p)()();var h=function(e){var t=e.users,n=e.messages,a=e.userName,c=e.roomId,r=e.onAddMessage,o=s.a.useState(""),u=Object(l.a)(o,2),i=u[0],j=u[1],b=s.a.useRef(null),d=function(e){"Enter"!=e.key&&"click"!=e.type||(f.emit("ROOM:NEW_MESSAGE",{userName:a,roomId:c,text:i}),r({userName:a,text:i}),j(""))};return s.a.useEffect((function(){b.current.scrollTo(0,99999)}),[n]),Object(O.jsxs)("div",{className:"chat",children:[Object(O.jsxs)("div",{className:"chat-users",children:["\u041a\u043e\u043c\u043d\u0430\u0442\u0430: ",Object(O.jsx)("b",{children:c}),Object(O.jsx)("hr",{}),Object(O.jsxs)("b",{children:["\u041e\u043d\u043b\u0430\u0439\u043d (",t.length,"):"]}),Object(O.jsx)("ul",{children:t.map((function(e,t){return Object(O.jsx)("li",{children:e},e+t)}))})]}),Object(O.jsxs)("div",{className:"chat-messages",children:[Object(O.jsx)("div",{ref:b,className:"messages",children:n.map((function(e){return Object(O.jsxs)("div",{className:"message",children:[Object(O.jsx)("p",{children:e.text}),Object(O.jsx)("div",{children:Object(O.jsx)("span",{children:e.userName})})]})}))}),Object(O.jsxs)("form",{children:[Object(O.jsx)("textarea",{onKeyPress:d,value:i,onChange:function(e){return j(e.target.value)},className:"form-control",rows:"3"}),Object(O.jsx)("button",{onClick:d,type:"button",className:"btn btn-primary",children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"})]})]})]})},x=n(50),y=function(e,t){switch(t.type){case"JOINED":return Object(o.a)(Object(o.a)({},e),{},{joined:!0,userName:t.payload.userName,roomId:t.payload.roomId});case"SET_DATA":return Object(o.a)(Object(o.a)({},e),{},{users:t.payload.users,messages:t.payload.messages});case"SET_USERS":return Object(o.a)(Object(o.a)({},e),{},{users:t.payload});case"NEW_MESSAGE":return Object(o.a)(Object(o.a)({},e),{},{messages:[].concat(Object(x.a)(e.messages),[t.payload])});default:return e}};var v=function(){var e=Object(a.useReducer)(y,{joined:!1,roomId:null,userName:null,users:[],messages:[]}),t=Object(l.a)(e,2),n=t[0],s=t[1],c=function(){var e=Object(j.a)(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s({type:"JOINED",payload:t}),f.emit("ROOM:JOIN",t),e.next=4,d.a.get("/rooms/".concat(t.roomId));case 4:n=e.sent,a=n.data,s({type:"SET_DATA",payload:a});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r=function(e){s({type:"SET_USERS",payload:e})},u=function(e){s({type:"NEW_MESSAGE",payload:e})};return Object(a.useEffect)((function(){f.on("ROOM:SET_USERS",r),f.on("ROOM:NEW_MESSAGE",u)}),[]),window.socket=f,Object(O.jsx)("div",{className:"wrapper",children:n.joined?Object(O.jsx)(h,Object(o.a)(Object(o.a)({},n),{},{onAddMessage:u})):Object(O.jsx)(m,{onLogin:c})})},g=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,106)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),a(e),s(e),c(e),r(e)}))};r.a.render(Object(O.jsx)(s.a.StrictMode,{children:Object(O.jsx)(v,{})}),document.getElementById("root")),g()},55:function(e,t,n){}},[[105,1,2]]]);
//# sourceMappingURL=main.9af58f1e.chunk.js.map